/*! gatekeeper.js - v0.0.1 - 2012-12-27
* Copyright (c) 2012 HIRAKI Satoru; Licensed Apache License, Version 2.0 */
(function(){var e,t,n,r,i,s,o,u,a,f;return u=0,o=0,s={},r={},a=function(e,t,n){var r;r=function(e){var t;t=void 0;if(t)return t;t==null&&(t=e.matches),t==null&&(t=e.webkitMatchesSelector);if(t===void 0)throw new Error("There is no mache element");return t};if(t==="_root")return n;if(e===n)return;if(r(e).call(e,t))return e;if(e.parentNode)return u++,a(e.parentNode,t,n)},t=function(e,t,n,r){var i,o,u,a,f,l;return(a=s[u=e.id])==null&&(s[u]={}),(f=(i=s[e.id])[t])==null&&(i[t]={}),(l=(o=s[e.id][t])[n])==null&&(o[n]=[]),s[e.id][t][n].push(r)},f=function(e,t,n,r){var i,o,u,a;if(!r&&!n){s[e.id][t]={};return}if(!r){delete s[e.id][t][n];return}o=0,u=s[e.id][t][n],i=u.length,a=[];while(o<i){if(u[o]===r){u.pop(o,1);break}a.push(o++)}return a},i=function(e,t,n){var i,o,f,l,c,h,p,d,v,m,g;g=s[e][n];if(!g)return;m=t.target,d=void 0,l=void 0,p={},o=0,f=0,u=0,i=function(e){return e.preventDefault(),e.stopPropagation()},v=Object.keys(g),v.forEach(function(i){var o,f;f=s[e][n][i],l=a(m,i,r[e].element),o=function(){return!0};if(l&&o(n,r[e].element,l,i==="_root",t))return u++,f.match=l,p[u]=f}),t.stopPropagation=function(){return t.cancelBubble=!0},o=0;while(o<=u){if(p[o]){f=0,c=p[o].length;while(f<c){h=p[o][f];if(h!=null&&h.call(p[o].match,t)===!1){i(t);return}if(t.cancelBubble)return;f++}}o++}},n=function(e,n,r,o){var u,a,l,c,h,p;a=function(e,t){var n;return n=Object.prototype.toString.call(t).slice(8,-1),t!=null&&n===e?!0:!1},u=function(e,t,n){var r;return r=t==="blur"||t==="focus",e.element.addEventListener(t,n,r)},a("Array",e)||(e=[e]),!r&&a("Function",n)&&(r=n,n="_root"),p=this.id,c=function(e){return i(p,e,c.original)},h=void 0,h=0,l=e.length;while(h<l)c.original=e[h],(!s[this.id]||!s[this.id][e[h]])&&u(this,e[h],c),o&&f(this,e[h],n,r),t(this,e[h],n,r),h++;return this},e=function(){function e(t,n){var i;if(!(this instanceof e)){for(i in r)if(r[i].element===t)return r[i];return o++,r[o]=new e(t,o),r[o]}this.element=t,this.id=o}return e.prototype.on=function(e,t,r){return n.call(this,e,t,r)},e.prototype.off=function(e,t,r){return n.call(this,e,t,r,!0)},e}(),window.Gk=e})();