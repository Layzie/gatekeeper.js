/*! gatekeeper - v0.0.2 - 2013-04-08
* Copyright (c) 2013 HIRAKI Satoru; Licensed Apache License, Version 2.0 */
(function(){var n,t,r,e,i,o,u,l,c,f;return l=0,u=0,o={},e={},c=function(n,t,r){var e;return e=function(n){var t;if(t=void 0)return t;if(null==t&&(t=n.matches),null==t&&(t=n.webkitMatchesSelector),void 0===t)throw Error("There is no mache element");return t},"_root"===t?r:n!==r?e(n).call(n,t)?n:n.parentNode?(l++,c(n.parentNode,t,r)):void 0:void 0},t=function(n,t,r,e){var i,u,l,c,f,a;return null==(c=o[l=n.id])&&(o[l]={}),null==(f=(i=o[n.id])[t])&&(i[t]={}),null==(a=(u=o[n.id][t])[r])&&(u[r]=[]),o[n.id][t][r].push(e)},f=function(n,t,r,e){var i,u,l,c;if(!e&&!r)return o[n.id][t]={},void 0;if(!e)return delete o[n.id][t][r],void 0;for(u=0,l=o[n.id][t][r],i=l.length,c=[];i>u;){if(l[u]===e){l.pop(u,1);break}c.push(u++)}return c},i=function(n,t,r){var i,u,f,a,d,h,v,s,p,m,b;if(b=o[n][r])for(m=t.target,s=void 0,a=void 0,v={},u=0,f=0,l=0,i=function(n){return n.preventDefault(),n.stopPropagation()},p=Object.keys(b),p.forEach(function(i){var u,f;return f=o[n][r][i],a=c(m,i,e[n].element),u=function(){return!0},a&&u(r,e[n].element,a,"_root"===i,t)?(l++,f.match=a,v[l]=f):void 0}),t.stopPropagation=function(){return t.cancelBubble=!0},u=0;l>=u;){if(v[u])for(f=0,d=v[u].length;d>f;){if(h=v[u][f],null!=h&&h.call(v[u].match,t)===!1)return i(t),void 0;if(t.cancelBubble)return;f++}u++}},r=function(n,r,e,u){var l,c,a,d,h,v;for(c=function(n,t){var r;return r=Object.prototype.toString.call(t).slice(8,-1),null!=t&&r===n?!0:!1},l=function(n,t,r){var e;return e="blur"===t||"focus"===t,n.element.addEventListener(t,r,e)},c("Array",n)||(n=[n]),!e&&c("Function",r)&&(e=r,r="_root"),h=this.id,d=0,a=n.length,v=function(n){return function(t){return i(h,t,n)}};a>d;)o[h]&&o[h][n[d]]||l(this,n[d],v(n[d])),u&&f(this,n[d],r,e),t(this,n[d],r,e),d++;return this},n=function(){function n(t,r){var i;if(!(this instanceof n)){for(i in e)if(e[i].element===t)return e[i];return u++,e[u]=new n(t,u),e[u]}this.element=t,this.id=r}return n.prototype.on=function(n,t,e){return r.call(this,n,t,e)},n.prototype.off=function(n,t,e){return r.call(this,n,t,e,!0)},n}(),window.Gk=n})();